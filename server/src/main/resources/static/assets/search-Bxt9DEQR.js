import{g as y,r as m,j as s}from"./index-Bm4W7kcw.js";import{F as u}from"./Feed-DBOQaBDA.js";import{f as l,L as x}from"./Layout-D9T89pnA.js";import{p as g}from"./posts-IdGjEV-3.js";import"./FollowButton-CZO9unpF.js";import"./useAuth-2B9FPw-q.js";import"./CodeBlock-C7OKY8nB.js";function h(e){return l({queryKey:["search",e],queryFn:({pageParam:r=0})=>g.searchPosts({...e,page:r}),getNextPageParam:r=>r.last?void 0:r.number+1,initialPageParam:0,enabled:e.keyword.length>0})}function w(){const e=y({from:"/search"}),{data:r,isLoading:o,isFetchingNextPage:n,hasNextPage:c,fetchNextPage:p,error:a}=h({keyword:e.keyword,type:e.type}),d=m.useMemo(()=>r?.pages.flatMap(t=>t.content)??[],[r]),i=()=>{const t={SNIPPET:"代码片段",ARTICLE:"文章",MOMENT:"动态"};return e.type?`未找到包含 "${e.keyword}" 的 ${t[e.type]}`:`未找到包含 "${e.keyword}" 的内容`};return s.jsx(x,{children:s.jsxs("div",{className:"space-y-4",children:[e.keyword&&s.jsxs("div",{className:"flex items-center gap-2 text-sm text-muted-foreground",children:[s.jsx("span",{children:"搜索:"}),s.jsxs("span",{className:"px-2 py-0.5 bg-secondary rounded-full",children:['"',e.keyword,'"']}),e.type&&s.jsxs("span",{className:"px-2 py-0.5 bg-secondary rounded-full",children:[e.type==="SNIPPET"&&"代码片段",e.type==="ARTICLE"&&"文章",e.type==="MOMENT"&&"动态"]})]}),a&&s.jsxs("div",{className:"p-4 text-center text-red-600 bg-red-50 rounded-lg",children:["搜索失败：",a.message]}),s.jsx(u,{posts:d,isLoading:o,isFetchingNextPage:n,hasNextPage:c,fetchNextPage:p,emptyMessage:i()})]})})}export{w as component};
